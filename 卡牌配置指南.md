# 卡牌配置指南

## 0. AI协作指南

### 基本工作流程
1. 你描述需要进行的卡牌修改
2. AI会根据你的描述执行相应的操作
3. AI会展示修改结果并等待你的确认

### 描述格式建议
```
操作类型：[添加/修改/删除/查询]
目标牌组：[牌组文件名]
具体操作：[详细描述]
```

### 操作类型示例

#### 添加卡牌
```
添加：basic_deck.txt
新增一张名为"火球术"的卡牌，效果是"对一名目标造成2点伤害，施加1层'燃烧'"
```

#### 修改卡牌
```
修改：basic_deck.txt
将"攻击"卡牌的伤害从1点改为1.5点
```

#### 批量修改
```
修改：basic_deck.txt
调整所有伤害类卡牌的伤害值，将现有伤害值增加0.5点
```

#### 删除卡牌
```
删除：basic_deck.txt
移除"毒药"卡牌
```

#### 查询卡牌
```
查询：basic_deck.txt
列出所有伤害大于1点的攻击卡牌
```

### AI响应方式
1. **确认理解**：AI会先复述你的要求以确保理解正确
2. **执行操作**：展示具体要进行的修改
3. **结果验证**：展示修改后的结果
4. **异常处理**：如果有任何问题，会详细说明并请求指导

### 特殊指令

#### 撤销修改
```
撤销：返回上一次修改前的状态
```

#### 批量处理
```
批量：[操作描述]
文件：basic_deck.txt, special_deck.txt
将所有牌组中的"中毒"效果层数增加1层
```

#### 条件筛选
```
筛选：basic_deck.txt
条件：伤害 > 1 且 包含状态效果
```

### 最佳实践
1. **明确目标**：清晰说明要修改的牌组和卡牌
2. **具体数值**：提供准确的数值变化
3. **分步操作**：复杂修改建议分步进行
4. **及时确认**：每步修改后及时确认结果

### 示例对话

```
用户：添加：basic_deck.txt
     新增一张"火球术"，效果是"对目标造成2点伤害并施加1层'燃烧'"

AI：我将在 basic_deck.txt 中添加以下卡牌：
    火球术:对一名目标造成2点伤害,施加1层"燃烧"
    是否确认添加？

用户：确认

AI：已添加卡牌。当前 basic_deck.txt 内容如下：
    [显示更新后的文件内容]
```

### 注意事项
1. 修改前AI会自动备份文件
2. 大规模修改会先请求确认
3. 不确定的修改会请求澄清
4. 可以随时要求查看当前状态

### 安全协作机制

#### 修改前验证
1. **语法检查**：AI会先验证修改是否符合语法规则
2. **数值范围**：检查数值是否在合理范围内
3. **效果组合**：验证效果组合是否合法
4. **目标兼容**：确认目标类型与效果匹配

#### 文件管理
1. **自动备份**
   ```
   # 备份命名格式
   [原文件名]_backup_[时间戳].txt
   
   # 示例
   basic_deck_backup_20240205_120130.txt
   ```

2. **版本追踪**
   ```
   # 在文件头部添加版本信息
   # Version: 1.0
   # Last Modified: 2024-02-05 12:01:30
   # Modified By: AI Assistant
   ```

#### 修改确认流程
1. **预览阶段**
   ```
   AI：以下是将要进行的修改：
   - 原内容：攻击:对一名目标造成1点伤害
   - 新内容：攻击:对一名目标造成1.5点伤害
   是否确认修改？
   ```

2. **影响分析**
   ```
   AI：此修改将影响：
   - 基础伤害值提升50%
   - 可能影响游戏平衡
   建议：考虑同步调整其他卡牌
   ```

3. **回滚机制**
   ```
   用户：撤销上次修改
   AI：将从备份恢复：basic_deck_backup_20240205_120130.txt
   ```

#### 异常处理
1. **无效修改拦截**
   ```
   ❌ 拦截示例：
   用户：将攻击牌伤害改为-1点
   AI：无效修改：伤害值不能为负数
   ```

2. **冲突检测**
   ```
   ❌ 冲突示例：
   用户：添加效果"对自身造成伤害并获得无敌"
   AI：检测到效果冲突：无敌状态与受伤机制冲突
   ```

3. **重复检查**
   ```
   ❌ 重复示例：
   用户：添加新卡牌"攻击"
   AI：检测到重名卡牌，建议使用其他名称
   ```

#### 管理器交互规则
1. **卡牌注册检查**
   - 检查卡牌ID唯一性
   - 验证命名空间合法性
   - 确认效果实现可行性

2. **效果实现验证**
   ```
   AI检查清单：
   □ 效果是否在系统支持范围内
   □ 所需组件是否都已实现
   □ 是否符合现有卡牌框架
   ```

3. **性能考虑**
   ```
   AI会评估：
   - 效果复杂度是否合理
   - 是否会导致性能问题
   - 是否需要特殊优化
   ```

#### 最佳协作实践
1. **渐进式修改**
   ```
   # 推荐方式
   1. 先修改单个数值
   2. 测试确认效果
   3. 再进行复杂修改
   ```

2. **批量操作安全**
   ```
   # 批量修改流程
   1. 先展示所有将要修改的项
   2. 提供预期结果预览
   3. 确认后分步执行
   4. 每步提供回滚点
   ```

3. **状态同步**
   ```
   # 每次修改后AI会确认：
   - 文件状态
   - 卡牌管理器状态
   - 修改历史记录
   ```

4. **修改记录**
   ```
   # 在文件末尾维护修改日志
   # === 修改记录 ===
   # 2024-02-05: 调整攻击牌伤害
   # 2024-02-05: 添加新卡牌"火球术"
   ```

## 1. 基本格式

### 卡牌定义格式
```
卡牌名称:效果描述1,效果描述2,...
```

### 示例
```
攻击:对一名目标造成1点伤害
连击:对一名目标造成0.5点伤害,对一名目标造成0.5点伤害
```

## 2. 效果描述语法

### 伤害效果
```
对[目标类型]造成[数值]点伤害
```
- 示例：
  - `对一名目标造成1点伤害`
  - `对所有目标造成0.5点伤害`

### 防御效果
```
获得[数值]点防御值
获得[数值]点固定防御值
```
- 示例：
  - `获得1点防御值`
  - `获得2点固定防御值`

### 治疗效果
```
恢复[数值]点血量
```
- 示例：
  - `恢复1点血量`
  - `恢复0.5点血量`

### 抽牌效果
```
抽[数值]张卡牌
```
- 示例：
  - `抽1张卡牌`
  - `抽2张卡牌`

### 状态效果
```
施加[数值]层"[状态名称]"
```
- 示例：
  - `施加2层"中毒"`
  - `施加1层"燃烧"`

## 3. 目标类型
- `一名目标`：单体目标
- `所有目标`：所有玩家
- `自身`：施放者自己
- `除自身外的所有目标`：除施放者外的所有玩家

## 4. 复合效果示例

### 多重效果
```
生命汲取:对一名目标造成1点伤害,恢复0.5点血量
回复:恢复0.5点血量,抽1张卡牌
```

### 连续相同效果
```
双重打击:对一名目标造成1点伤害,对一名目标造成1点伤害
```

## 5. 数值规则
- 伤害/治疗值：支持0.1为最小单位
- 防御值：支持0.1为最小单位
- 抽牌数：必须为整数
- 状态层数：必须为整数

## 6. 特殊规则

### 注释
```
# 这是一行注释
# 基础卡牌配置
```

### 空行
- 配置文件中可以包含空行，会被自动忽略

## 7. 完整示例

```
# 基础卡牌
攻击:对一名目标造成1点伤害
防御:获得1点防御值
治疗:恢复1点血量

# 复合效果卡牌
生命汲取:对一名目标造成1点伤害,恢复0.5点血量
连击:对一名目标造成0.5点伤害,对一名目标造成0.5点伤害

# 状态卡牌
毒药:施加2层"中毒"
燃烧:施加1层"燃烧"

# 特殊卡牌
护甲强化:获得1点防御值,获得1点固定防御值
战术抽牌:造成0.5点伤害,抽2张卡牌
```

## 8. 如何修改卡牌

### 添加新卡牌
1. 打开对应的卡牌配置文件（如 `basic_deck.txt`）
2. 按照格式添加新的卡牌定义
3. 保存文件

### 修改现有卡牌
1. 在配置文件中找到要修改的卡牌
2. 修改卡牌名称或效果描述
3. 保存文件

### 删除卡牌
1. 在配置文件中找到要删除的卡牌
2. 删除整行或注释掉（在行首添加#）
3. 保存文件

## 9. 常见错误处理

### 格式错误
❌ 错误：`攻击-对一名目标造成1点伤害`
✅ 正确：`攻击:对一名目标造成1点伤害`

### 数值错误
❌ 错误：`攻击:对一名目标造成1.23点伤害`
✅ 正确：`攻击:对一名目标造成1.2点伤害`

### 效果描述错误
❌ 错误：`攻击:造成1点伤害给一名目标`
✅ 正确：`攻击:对一名目标造成1点伤害`

### 分隔符错误
❌ 错误：`连击:对一名目标造成0.5点伤害;对一名目标造成0.5点伤害`
✅ 正确：`连击:对一名目标造成0.5点伤害,对一名目标造成0.5点伤害` 